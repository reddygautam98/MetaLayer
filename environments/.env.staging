# Staging Environment Configuration

# =============================================================================
# ENVIRONMENT SETTINGS
# =============================================================================
ENVIRONMENT=staging
DEPLOYMENT_MODE=staging

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
POSTGRES_DB=airflow_staging
POSTGRES_USER=postgres
# POSTGRES_PASSWORD should be set via GitHub Secrets

# =============================================================================
# AIRFLOW CONFIGURATION
# =============================================================================
AIRFLOW_UID=50000
AIRFLOW_GID=0
_AIRFLOW_WWW_USER_USERNAME=admin
# _AIRFLOW_WWW_USER_PASSWORD should be set via GitHub Secrets

# Airflow Performance Settings (Reduced for staging)
AIRFLOW__CORE__PARALLELISM=32
AIRFLOW__CORE__DAG_CONCURRENCY=16
AIRFLOW__CORE__MAX_ACTIVE_RUNS_PER_DAG=4
AIRFLOW__CORE__MAX_ACTIVE_TASKS_PER_DAG=16

# Airflow Security Settings
AIRFLOW__WEBSERVER__EXPOSE_CONFIG=true  # Allow config view in staging
AIRFLOW__WEBSERVER__ENABLE_PROXY_FIX=true
AIRFLOW__CORE__SECURITY=true
AIRFLOW__API__AUTH_BACKENDS=airflow.api.auth.backend.basic_auth

# =============================================================================
# MONITORING CONFIGURATION
# =============================================================================
# Grafana Admin Credentials
GF_SECURITY_ADMIN_USER=admin
# GF_SECURITY_ADMIN_PASSWORD should be set via GitHub Secrets

# Prometheus Settings (Reduced retention for staging)
PROMETHEUS_RETENTION_TIME=7d
PROMETHEUS_STORAGE_RETENTION_SIZE=2GB

# =============================================================================
# RESOURCE LIMITS (Reduced for staging)
# =============================================================================
# PostgreSQL
POSTGRES_MAX_CONNECTIONS=100
POSTGRES_SHARED_BUFFERS=128MB
POSTGRES_EFFECTIVE_CACHE_SIZE=512MB

# Docker Resource Limits
WEBSERVER_CPU_LIMIT=1.0
WEBSERVER_MEMORY_LIMIT=2G
SCHEDULER_CPU_LIMIT=0.5
SCHEDULER_MEMORY_LIMIT=1G

# =============================================================================
# NETWORK CONFIGURATION
# =============================================================================
# External Port Mappings
AIRFLOW_WEBSERVER_PORT=8080
GRAFANA_PORT=3000
PROMETHEUS_PORT=9090
POSTGRES_EXTERNAL_PORT=5433

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================
BACKUP_RETENTION_DAYS=7
BACKUP_SCHEDULE="0 3 * * *"  # Daily at 3 AM
BACKUP_S3_BUCKET=""  # Optional: S3 bucket for backups

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
AIRFLOW__LOGGING__LOGGING_LEVEL=DEBUG  # More verbose logging for staging
AIRFLOW__LOGGING__REMOTE_LOGGING=false
LOG_RETENTION_DAYS=7

# =============================================================================
# DATA PIPELINE SETTINGS (Smaller batches for testing)
# =============================================================================
# Processing Batch Sizes
BRONZE_BATCH_SIZE=1000
SILVER_BATCH_SIZE=500
GOLD_BATCH_SIZE=100

# Data Quality Thresholds (More lenient for staging)
DATA_QUALITY_THRESHOLD=0.80
FRESHNESS_THRESHOLD_HOURS=48

# =============================================================================
# ALERTING CONFIGURATION
# =============================================================================
ALERT_EMAIL_ENABLED=false  # Disabled for staging
SLACK_WEBHOOK_ENABLED=false
ALERT_EMAIL_RECIPIENTS=""
SLACK_WEBHOOK_URL=""

# =============================================================================
# FEATURE FLAGS (Enable experimental features in staging)
# =============================================================================
ENABLE_DATA_LINEAGE=true
ENABLE_COST_MONITORING=true  
ENABLE_PERFORMANCE_PROFILING=true
ENABLE_DEBUG_LOGGING=true